\doxysection{C\+:/\+Users/\+P/\+Documents/\+Projeto\+\_\+\+Comedouro\+\_\+\+PIPE/comeint-\/fw/feeder-\/fw/components/app\+\_\+beacon/app\+\_\+beacon.c File Reference}
\hypertarget{app__beacon_8c}{}\label{app__beacon_8c}\index{C:/Users/P/Documents/Projeto\_Comedouro\_PIPE/comeint-\/fw/feeder-\/fw/components/app\_beacon/app\_beacon.c@{C:/Users/P/Documents/Projeto\_Comedouro\_PIPE/comeint-\/fw/feeder-\/fw/components/app\_beacon/app\_beacon.c}}


Contains beacon-\/related code.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include "{}esp\+\_\+log.\+h"{}}\newline
{\ttfamily \#include "{}esp\+\_\+err.\+h"{}}\newline
{\ttfamily \#include "{}esp\+\_\+bt.\+h"{}}\newline
{\ttfamily \#include "{}esp\+\_\+bt\+\_\+defs.\+h"{}}\newline
{\ttfamily \#include "{}esp\+\_\+bt\+\_\+main.\+h"{}}\newline
{\ttfamily \#include "{}esp\+\_\+gap\+\_\+ble\+\_\+api.\+h"{}}\newline
{\ttfamily \#include "{}app\+\_\+beacon.\+h"{}}\newline
{\ttfamily \#include "{}app\+\_\+status.\+h"{}}\newline
{\ttfamily \#include "{}app\+\_\+pwm.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structbeacon__t}{beacon\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Typedef to store information about the beacon. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{app__beacon_8c_a5155a7b7465dd9b5e6167122827d0158}\label{app__beacon_8c_a5155a7b7465dd9b5e6167122827d0158} 
\#define {\bfseries LOG\+\_\+\+LOCAL\+\_\+\+LEVEL}~ESP\+\_\+\+LOG\+\_\+\+NONE
\begin{DoxyCompactList}\small\item\em Defines the log level. See \href{https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/log.html}{\texttt{ https\+://docs.\+espressif.\+com/projects/esp-\/idf/en/stable/esp32/api-\/reference/system/log.\+html}} for more information. \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a6174730cc000d98e7a1a788ac0d4c0ae}\label{app__beacon_8c_a6174730cc000d98e7a1a788ac0d4c0ae} 
\#define {\bfseries SCAN\+\_\+\+FILTER\+\_\+\+MAC}~(1)
\begin{DoxyCompactList}\small\item\em Filter scan by MAC address (0\+: False, other\+: True) \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a88b69e04e3080524f810f4e02fe0c3c8}\label{app__beacon_8c_a88b69e04e3080524f810f4e02fe0c3c8} 
\#define {\bfseries SCAN\+\_\+\+FILTER\+\_\+\+RSSI}~(0)
\begin{DoxyCompactList}\small\item\em Filter scan by RSSI (0\+: False, other\+: True) \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a14cabbbda67f17a92cb2240b81c71682}\label{app__beacon_8c_a14cabbbda67f17a92cb2240b81c71682} 
\#define {\bfseries SCAN\+\_\+\+FILTER\+\_\+\+EDD\+\_\+\+TLM}~(1)
\begin{DoxyCompactList}\small\item\em Filter scan by data type (Eddystone TLM) (0\+: False, other\+: True) \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a67640667990ffa38664df995f9d348e0}\label{app__beacon_8c_a67640667990ffa38664df995f9d348e0} 
\#define {\bfseries PRINT\+\_\+\+ADV\+\_\+\+DATA}~(0)
\begin{DoxyCompactList}\small\item\em Print advertisements raw data (0\+: False, other\+: True) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bd}{ble\+\_\+scan\+\_\+status\+\_\+t}} \{ \newline
\mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865}{ble\+\_\+scan\+\_\+uninit}} = 0
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac}{ble\+\_\+scan\+\_\+initialing}}
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5}{ble\+\_\+scan\+\_\+off}}
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031}{ble\+\_\+scan\+\_\+starting}}
, \newline
\mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe}{ble\+\_\+scan\+\_\+on}}
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a}{ble\+\_\+scan\+\_\+stopping}}
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1}{ble\+\_\+scan\+\_\+start\+\_\+pending}}
, \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b}{ble\+\_\+scan\+\_\+stop\+\_\+pending}}
 \}
\begin{DoxyCompactList}\small\item\em Typedef for storing the status of the BLE scan. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{app__beacon_8c_a447781418f499b7b9f6fd778500a2bce}{app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+gap\+\_\+cb}} (esp\+\_\+gap\+\_\+ble\+\_\+cb\+\_\+event\+\_\+t event, esp\+\_\+ble\+\_\+gap\+\_\+cb\+\_\+param\+\_\+t \texorpdfstring{$\ast$}{*}param)
\begin{DoxyCompactList}\small\item\em BLE GAP event handler. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{app__beacon_8c_afa355b6e9f4a03afc9af7bf395e7b6f8}{app\+\_\+beacon\+\_\+\+\_\+beacon\+\_\+check\+\_\+task}} (void \texorpdfstring{$\ast$}{*}arg)
\begin{DoxyCompactList}\small\item\em This task checks if the number of times that the beacon has been seen when the task was resumed is different from the number of times it was seen some seconds later. If the numbers are not different, it means that the beacon has not been seen for some time and in this case the lid will be closed and beacon.\+found will be set to zero. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{app__beacon_8c_ab7400345952e53011876e57971505a65}{app\+\_\+beacon\+\_\+\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize necessary stuff to perform BLE scan. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{app__beacon_8c_abe33c18c55161d20e7aff59090894e32}{app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+scan\+\_\+start}} (void)
\begin{DoxyCompactList}\small\item\em Start BLE scan. If scan is stopping, scan start is put into pending state, so it is started after it finishes stopping. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{app__beacon_8c_a929b0ba225cd078bc7f114f7ff00f3d0}{app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+scan\+\_\+stop}} (void)
\begin{DoxyCompactList}\small\item\em Stop BLE scan. If scan is starting, scan stop is put into pending state, so it is stopped after it finishes starting. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{app__beacon_8c_a40cdef624cff3637675eac3102b290d2}{app\+\_\+beacon\+\_\+\+\_\+set\+\_\+auth\+\_\+mac}} (uint8\+\_\+t mac\+\_\+addr\mbox{[}6\mbox{]})
\begin{DoxyCompactList}\small\item\em Sets authorized MAC address in beacon structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{app__beacon_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}\label{app__beacon_8c_a5a85b9c772bbeb480b209a3e6ea92b4c} 
static const char \texorpdfstring{$\ast$}{*} {\bfseries TAG} = "{}app\+\_\+beacon"{}
\begin{DoxyCompactList}\small\item\em Tag to be used when logging. \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a4103d41f6b46590f9afbaac12ce35e98}\label{app__beacon_8c_a4103d41f6b46590f9afbaac12ce35e98} 
static \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bd}{ble\+\_\+scan\+\_\+status\+\_\+t}} {\bfseries scan\+\_\+status} = \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865}{ble\+\_\+scan\+\_\+uninit}}
\begin{DoxyCompactList}\small\item\em Variable that holds BLE scan status. \end{DoxyCompactList}\item 
static esp\+\_\+ble\+\_\+scan\+\_\+params\+\_\+t \mbox{\hyperlink{app__beacon_8c_a7a4ed22f5f5f667dc82f4899aa0bdc71}{ble\+\_\+scan\+\_\+params}}
\begin{DoxyCompactList}\small\item\em BLE scan parameters. \end{DoxyCompactList}\item 
static const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{app__beacon_8c_a2c8a5c76fd569b6057d16ce79a4d4984}{scan\+\_\+statuses\+\_\+str}} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em BLE scan statuses as strings for debugging. \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a760745ffe4296454243fff3861c7013f}\label{app__beacon_8c_a760745ffe4296454243fff3861c7013f} 
static int {\bfseries min\+\_\+rssi} = -\/47
\begin{DoxyCompactList}\small\item\em Minimum RSSI for detection (dB) \end{DoxyCompactList}\item 
static \mbox{\hyperlink{structbeacon__t}{beacon\+\_\+t}} \mbox{\hyperlink{app__beacon_8c_a06a33a9029fb7caf6bc0a3bc8313c852}{beacon}}
\begin{DoxyCompactList}\small\item\em Variable that holds beacon information ///\texorpdfstring{$<$}{<} Beacon information. \end{DoxyCompactList}\item 
\Hypertarget{app__beacon_8c_a32d7f423777d1c396c95031c556494ef}\label{app__beacon_8c_a32d7f423777d1c396c95031c556494ef} 
static Task\+Handle\+\_\+t {\bfseries app\+\_\+beacon\+\_\+\+\_\+beacon\+\_\+check\+\_\+task\+\_\+handle} = NULL
\begin{DoxyCompactList}\small\item\em Beacon lost check task handle. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains beacon-\/related code. 

\begin{DoxyAuthor}{Author}
Henrique Sander LourenÃ§o (\href{mailto:henriquesander27@gmail.com}{\texttt{ henriquesander27@gmail.\+com}}) 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2024-\/03-\/24
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2024 Pet\+Dog
\end{DoxyCopyright}
Copyright 2024 Pet\+Dog

Licensed under the Apache License, Version 2.\+0 (the "{}\+License"{}); you may not use this file except in compliance with the License. You may obtain a copy of the License at \begin{DoxyVerb}http://www.apache.org/licenses/LICENSE-2.0
\end{DoxyVerb}
 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "{}\+AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\textquotesingle{} See the License for the specific language governing permissions and limitations under the License. 

\doxysubsection{Enumeration Type Documentation}
\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bd}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bd} 
\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_status\_t@{ble\_scan\_status\_t}}
\index{ble\_scan\_status\_t@{ble\_scan\_status\_t}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{ble\_scan\_status\_t}{ble\_scan\_status\_t}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bd}{ble\+\_\+scan\+\_\+status\+\_\+t}}}



Typedef for storing the status of the BLE scan. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_uninit@{ble\_scan\_uninit}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_uninit@{ble\_scan\_uninit}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865} 
ble\+\_\+scan\+\_\+uninit&BLE scan uninitialized \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_initialing@{ble\_scan\_initialing}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_initialing@{ble\_scan\_initialing}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac} 
ble\+\_\+scan\+\_\+initialing&BLE scan initializing \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_off@{ble\_scan\_off}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_off@{ble\_scan\_off}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5} 
ble\+\_\+scan\+\_\+off&BLE scan off \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_starting@{ble\_scan\_starting}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_starting@{ble\_scan\_starting}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031} 
ble\+\_\+scan\+\_\+starting&BLE scan starting \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_on@{ble\_scan\_on}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_on@{ble\_scan\_on}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe} 
ble\+\_\+scan\+\_\+on&BLE scan on \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_stopping@{ble\_scan\_stopping}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_stopping@{ble\_scan\_stopping}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a} 
ble\+\_\+scan\+\_\+stopping&BLE scan stopping \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_start\_pending@{ble\_scan\_start\_pending}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_start\_pending@{ble\_scan\_start\_pending}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1} 
ble\+\_\+scan\+\_\+start\+\_\+pending&BLE scan requested to be started while it could not be instantly started \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ble\_scan\_stop\_pending@{ble\_scan\_stop\_pending}!app\_beacon.c@{app\_beacon.c}}\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_stop\_pending@{ble\_scan\_stop\_pending}}}\Hypertarget{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b}\label{app__beacon_8c_aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b} 
ble\+\_\+scan\+\_\+stop\+\_\+pending&BLE scan requested to be stopped while it could not be instantly stopped \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\Hypertarget{app__beacon_8c_afa355b6e9f4a03afc9af7bf395e7b6f8}\label{app__beacon_8c_afa355b6e9f4a03afc9af7bf395e7b6f8} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_beacon\_check\_task@{app\_beacon\_\_beacon\_check\_task}}
\index{app\_beacon\_\_beacon\_check\_task@{app\_beacon\_\_beacon\_check\_task}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_beacon\_check\_task()}{app\_beacon\_\_beacon\_check\_task()}}
{\footnotesize\ttfamily static void app\+\_\+beacon\+\_\+\+\_\+beacon\+\_\+check\+\_\+task (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{arg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



This task checks if the number of times that the beacon has been seen when the task was resumed is different from the number of times it was seen some seconds later. If the numbers are not different, it means that the beacon has not been seen for some time and in this case the lid will be closed and beacon.\+found will be set to zero. 


\begin{DoxyParams}{Parameters}
{\em arg} & \\
\hline
\end{DoxyParams}
\Hypertarget{app__beacon_8c_a447781418f499b7b9f6fd778500a2bce}\label{app__beacon_8c_a447781418f499b7b9f6fd778500a2bce} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_ble\_gap\_cb@{app\_beacon\_\_ble\_gap\_cb}}
\index{app\_beacon\_\_ble\_gap\_cb@{app\_beacon\_\_ble\_gap\_cb}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_ble\_gap\_cb()}{app\_beacon\_\_ble\_gap\_cb()}}
{\footnotesize\ttfamily static void app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+gap\+\_\+cb (\begin{DoxyParamCaption}\item[{esp\+\_\+gap\+\_\+ble\+\_\+cb\+\_\+event\+\_\+t}]{event,  }\item[{esp\+\_\+ble\+\_\+gap\+\_\+cb\+\_\+param\+\_\+t \texorpdfstring{$\ast$}{*}}]{param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



BLE GAP event handler. 


\begin{DoxyParams}{Parameters}
{\em event} & Tell which event happened. \\
\hline
{\em param} & Pointer to union with other event data. \\
\hline
\end{DoxyParams}
\Hypertarget{app__beacon_8c_abe33c18c55161d20e7aff59090894e32}\label{app__beacon_8c_abe33c18c55161d20e7aff59090894e32} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_ble\_scan\_start@{app\_beacon\_\_ble\_scan\_start}}
\index{app\_beacon\_\_ble\_scan\_start@{app\_beacon\_\_ble\_scan\_start}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_ble\_scan\_start()}{app\_beacon\_\_ble\_scan\_start()}}
{\footnotesize\ttfamily esp\+\_\+err\+\_\+t app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+scan\+\_\+start (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Start BLE scan. If scan is stopping, scan start is put into pending state, so it is started after it finishes stopping. 

\begin{DoxyReturn}{Returns}
esp\+\_\+err\+\_\+t 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em ESP\+\_\+\+OK} & on success. \\
\hline
{\em Error} & code on failure. \\
\hline
\end{DoxyRetVals}
\Hypertarget{app__beacon_8c_a929b0ba225cd078bc7f114f7ff00f3d0}\label{app__beacon_8c_a929b0ba225cd078bc7f114f7ff00f3d0} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_ble\_scan\_stop@{app\_beacon\_\_ble\_scan\_stop}}
\index{app\_beacon\_\_ble\_scan\_stop@{app\_beacon\_\_ble\_scan\_stop}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_ble\_scan\_stop()}{app\_beacon\_\_ble\_scan\_stop()}}
{\footnotesize\ttfamily esp\+\_\+err\+\_\+t app\+\_\+beacon\+\_\+\+\_\+ble\+\_\+scan\+\_\+stop (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Stop BLE scan. If scan is starting, scan stop is put into pending state, so it is stopped after it finishes starting. 

\begin{DoxyReturn}{Returns}
esp\+\_\+err\+\_\+t 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em ESP\+\_\+\+OK} & on success. \\
\hline
{\em Error} & code on failure. \\
\hline
\end{DoxyRetVals}
\Hypertarget{app__beacon_8c_ab7400345952e53011876e57971505a65}\label{app__beacon_8c_ab7400345952e53011876e57971505a65} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_init@{app\_beacon\_\_init}}
\index{app\_beacon\_\_init@{app\_beacon\_\_init}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_init()}{app\_beacon\_\_init()}}
{\footnotesize\ttfamily esp\+\_\+err\+\_\+t app\+\_\+beacon\+\_\+\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize necessary stuff to perform BLE scan. 

\begin{DoxyReturn}{Returns}
esp\+\_\+err\+\_\+t 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em ESP\+\_\+\+OK} & on success. \\
\hline
{\em Error} & code on failure. \\
\hline
\end{DoxyRetVals}
\Hypertarget{app__beacon_8c_a40cdef624cff3637675eac3102b290d2}\label{app__beacon_8c_a40cdef624cff3637675eac3102b290d2} 
\index{app\_beacon.c@{app\_beacon.c}!app\_beacon\_\_set\_auth\_mac@{app\_beacon\_\_set\_auth\_mac}}
\index{app\_beacon\_\_set\_auth\_mac@{app\_beacon\_\_set\_auth\_mac}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{app\_beacon\_\_set\_auth\_mac()}{app\_beacon\_\_set\_auth\_mac()}}
{\footnotesize\ttfamily void app\+\_\+beacon\+\_\+\+\_\+set\+\_\+auth\+\_\+mac (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{mac\+\_\+addr\mbox{[}6\mbox{]} }\end{DoxyParamCaption})}



Sets authorized MAC address in beacon structure. 


\begin{DoxyParams}{Parameters}
{\em mac\+\_\+addr} & 6 bytes array with authorized MAC address. \\
\hline
\end{DoxyParams}


\doxysubsection{Variable Documentation}
\Hypertarget{app__beacon_8c_a06a33a9029fb7caf6bc0a3bc8313c852}\label{app__beacon_8c_a06a33a9029fb7caf6bc0a3bc8313c852} 
\index{app\_beacon.c@{app\_beacon.c}!beacon@{beacon}}
\index{beacon@{beacon}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{beacon}{beacon}}
{\footnotesize\ttfamily \mbox{\hyperlink{structbeacon__t}{beacon\+\_\+t}} beacon\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .auth\_mac\ =\ \{0\},}
\DoxyCodeLine{\ \ \ \ .found\ =\ 0,}
\DoxyCodeLine{\ \ \ \ .times\_seen\ =\ 0,}
\DoxyCodeLine{\}}

\end{DoxyCode}


Variable that holds beacon information ///\texorpdfstring{$<$}{<} Beacon information. 

\Hypertarget{app__beacon_8c_a7a4ed22f5f5f667dc82f4899aa0bdc71}\label{app__beacon_8c_a7a4ed22f5f5f667dc82f4899aa0bdc71} 
\index{app\_beacon.c@{app\_beacon.c}!ble\_scan\_params@{ble\_scan\_params}}
\index{ble\_scan\_params@{ble\_scan\_params}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{ble\_scan\_params}{ble\_scan\_params}}
{\footnotesize\ttfamily esp\+\_\+ble\+\_\+scan\+\_\+params\+\_\+t ble\+\_\+scan\+\_\+params\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ .scan\_type\ =\ BLE\_SCAN\_TYPE\_PASSIVE,}
\DoxyCodeLine{\ \ \ \ .own\_addr\_type\ =\ BLE\_ADDR\_TYPE\_PUBLIC,}
\DoxyCodeLine{\ \ \ \ .scan\_filter\_policy\ =\ BLE\_SCAN\_FILTER\_ALLOW\_ALL,}
\DoxyCodeLine{\ \ \ \ .scan\_interval\ =\ 500,\ }
\DoxyCodeLine{\ \ \ \ .scan\_window\ =\ 400,\ \ \ }
\DoxyCodeLine{\ \ \ \ .scan\_duplicate\ =\ BLE\_SCAN\_DUPLICATE\_DISABLE,}
\DoxyCodeLine{\}}

\end{DoxyCode}


BLE scan parameters. 

\Hypertarget{app__beacon_8c_a2c8a5c76fd569b6057d16ce79a4d4984}\label{app__beacon_8c_a2c8a5c76fd569b6057d16ce79a4d4984} 
\index{app\_beacon.c@{app\_beacon.c}!scan\_statuses\_str@{scan\_statuses\_str}}
\index{scan\_statuses\_str@{scan\_statuses\_str}!app\_beacon.c@{app\_beacon.c}}
\doxysubsubsection{\texorpdfstring{scan\_statuses\_str}{scan\_statuses\_str}}
{\footnotesize\ttfamily const char\texorpdfstring{$\ast$}{*} scan\+\_\+statuses\+\_\+str\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_uninit"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_initialing"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_off"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_starting"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_on"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_stopping"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_start\_pending"{}},}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}ble\_scan\_stop\_pending"{}},}
\DoxyCodeLine{\}}

\end{DoxyCode}


BLE scan statuses as strings for debugging. 

