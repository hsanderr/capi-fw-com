<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ComeInt FW: C:/Users/P/Documents/Projeto_Comedouro_PIPE/comeint-fw/feeder-fw/components/app_beacon/app_beacon.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ComeInt FW<span id="projectnumber">&#160;alpha</span>
   </div>
   <div id="projectbrief">This is the project synopsis.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_575991f2b98040f8ebe7b7fd676bc469.html">P</a></li><li class="navelem"><a class="el" href="dir_e6ac30d421164a119359b15f4f9fc677.html">Documents</a></li><li class="navelem"><a class="el" href="dir_e95314d338ca76db1e05b81403e054ad.html">Projeto_Comedouro_PIPE</a></li><li class="navelem"><a class="el" href="dir_afcf255bd2fc812188a6bf51f8da7913.html">comeint-fw</a></li><li class="navelem"><a class="el" href="dir_8b78b161c5f6185a9d30de1ec020d0ef.html">feeder-fw</a></li><li class="navelem"><a class="el" href="dir_c5e957f2cac61da14525f95760338597.html">components</a></li><li class="navelem"><a class="el" href="dir_72b873f08615b3b458da91c8dace75cc.html">app_beacon</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">app_beacon.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains beacon-related code.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;esp_err.h&quot;</code><br />
<code>#include &quot;esp_bt.h&quot;</code><br />
<code>#include &quot;esp_bt_defs.h&quot;</code><br />
<code>#include &quot;esp_bt_main.h&quot;</code><br />
<code>#include &quot;esp_gap_ble_api.h&quot;</code><br />
<code>#include &quot;<a class="el" href="app__beacon_8h_source.html">app_beacon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app__status_8h_source.html">app_status.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app__pwm_8h_source.html">app_pwm.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbeacon__t.html">beacon_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef to store information about the beacon.  <a href="structbeacon__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5155a7b7465dd9b5e6167122827d0158" id="r_a5155a7b7465dd9b5e6167122827d0158"><td class="memItemLeft" align="right" valign="top"><a id="a5155a7b7465dd9b5e6167122827d0158" name="a5155a7b7465dd9b5e6167122827d0158"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LOG_LOCAL_LEVEL</b>&#160;&#160;&#160;ESP_LOG_NONE</td></tr>
<tr class="memdesc:a5155a7b7465dd9b5e6167122827d0158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the log level. See <a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/log.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/log.html</a> for more information. <br /></td></tr>
<tr class="separator:a5155a7b7465dd9b5e6167122827d0158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6174730cc000d98e7a1a788ac0d4c0ae" id="r_a6174730cc000d98e7a1a788ac0d4c0ae"><td class="memItemLeft" align="right" valign="top"><a id="a6174730cc000d98e7a1a788ac0d4c0ae" name="a6174730cc000d98e7a1a788ac0d4c0ae"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SCAN_FILTER_MAC</b>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:a6174730cc000d98e7a1a788ac0d4c0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter scan by MAC address (0: False, other: True) <br /></td></tr>
<tr class="separator:a6174730cc000d98e7a1a788ac0d4c0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b69e04e3080524f810f4e02fe0c3c8" id="r_a88b69e04e3080524f810f4e02fe0c3c8"><td class="memItemLeft" align="right" valign="top"><a id="a88b69e04e3080524f810f4e02fe0c3c8" name="a88b69e04e3080524f810f4e02fe0c3c8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SCAN_FILTER_RSSI</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:a88b69e04e3080524f810f4e02fe0c3c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter scan by RSSI (0: False, other: True) <br /></td></tr>
<tr class="separator:a88b69e04e3080524f810f4e02fe0c3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14cabbbda67f17a92cb2240b81c71682" id="r_a14cabbbda67f17a92cb2240b81c71682"><td class="memItemLeft" align="right" valign="top"><a id="a14cabbbda67f17a92cb2240b81c71682" name="a14cabbbda67f17a92cb2240b81c71682"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SCAN_FILTER_EDD_TLM</b>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:a14cabbbda67f17a92cb2240b81c71682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter scan by data type (Eddystone TLM) (0: False, other: True) <br /></td></tr>
<tr class="separator:a14cabbbda67f17a92cb2240b81c71682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67640667990ffa38664df995f9d348e0" id="r_a67640667990ffa38664df995f9d348e0"><td class="memItemLeft" align="right" valign="top"><a id="a67640667990ffa38664df995f9d348e0" name="a67640667990ffa38664df995f9d348e0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PRINT_ADV_DATA</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:a67640667990ffa38664df995f9d348e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print advertisements raw data (0: False, other: True) <br /></td></tr>
<tr class="separator:a67640667990ffa38664df995f9d348e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aef00d2df2e65dc4d98e35cf210b017bd" id="r_aef00d2df2e65dc4d98e35cf210b017bd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bd">ble_scan_status_t</a> { <br />
&#160;&#160;<a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865">ble_scan_uninit</a> = 0
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac">ble_scan_initialing</a>
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5">ble_scan_off</a>
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031">ble_scan_starting</a>
, <br />
&#160;&#160;<a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe">ble_scan_on</a>
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a">ble_scan_stopping</a>
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1">ble_scan_start_pending</a>
, <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b">ble_scan_stop_pending</a>
<br />
 }</td></tr>
<tr class="memdesc:aef00d2df2e65dc4d98e35cf210b017bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef for storing the status of the BLE scan.  <a href="#aef00d2df2e65dc4d98e35cf210b017bd">More...</a><br /></td></tr>
<tr class="separator:aef00d2df2e65dc4d98e35cf210b017bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a447781418f499b7b9f6fd778500a2bce" id="r_a447781418f499b7b9f6fd778500a2bce"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a447781418f499b7b9f6fd778500a2bce">app_beacon__ble_gap_cb</a> (esp_gap_ble_cb_event_t event, esp_ble_gap_cb_param_t *param)</td></tr>
<tr class="memdesc:a447781418f499b7b9f6fd778500a2bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">BLE GAP event handler.  <br /></td></tr>
<tr class="separator:a447781418f499b7b9f6fd778500a2bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa355b6e9f4a03afc9af7bf395e7b6f8" id="r_afa355b6e9f4a03afc9af7bf395e7b6f8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa355b6e9f4a03afc9af7bf395e7b6f8">app_beacon__beacon_check_task</a> (void *arg)</td></tr>
<tr class="memdesc:afa355b6e9f4a03afc9af7bf395e7b6f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This task checks if the number of times that the beacon has been seen when the task was resumed is different from the number of times it was seen some seconds later. If the numbers are not different, it means that the beacon has not been seen for some time and in this case the lid will be closed and beacon.found will be set to zero.  <br /></td></tr>
<tr class="separator:afa355b6e9f4a03afc9af7bf395e7b6f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7400345952e53011876e57971505a65" id="r_ab7400345952e53011876e57971505a65"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7400345952e53011876e57971505a65">app_beacon__init</a> (void)</td></tr>
<tr class="memdesc:ab7400345952e53011876e57971505a65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize necessary stuff to perform BLE scan.  <br /></td></tr>
<tr class="separator:ab7400345952e53011876e57971505a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe33c18c55161d20e7aff59090894e32" id="r_abe33c18c55161d20e7aff59090894e32"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe33c18c55161d20e7aff59090894e32">app_beacon__ble_scan_start</a> (void)</td></tr>
<tr class="memdesc:abe33c18c55161d20e7aff59090894e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start BLE scan. If scan is stopping, scan start is put into pending state, so it is started after it finishes stopping.  <br /></td></tr>
<tr class="separator:abe33c18c55161d20e7aff59090894e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929b0ba225cd078bc7f114f7ff00f3d0" id="r_a929b0ba225cd078bc7f114f7ff00f3d0"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a929b0ba225cd078bc7f114f7ff00f3d0">app_beacon__ble_scan_stop</a> (void)</td></tr>
<tr class="memdesc:a929b0ba225cd078bc7f114f7ff00f3d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop BLE scan. If scan is starting, scan stop is put into pending state, so it is stopped after it finishes starting.  <br /></td></tr>
<tr class="separator:a929b0ba225cd078bc7f114f7ff00f3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40cdef624cff3637675eac3102b290d2" id="r_a40cdef624cff3637675eac3102b290d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40cdef624cff3637675eac3102b290d2">app_beacon__set_auth_mac</a> (uint8_t mac_addr[6])</td></tr>
<tr class="memdesc:a40cdef624cff3637675eac3102b290d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets authorized MAC address in beacon structure.  <br /></td></tr>
<tr class="separator:a40cdef624cff3637675eac3102b290d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a85b9c772bbeb480b209a3e6ea92b4c" id="r_a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memItemLeft" align="right" valign="top"><a id="a5a85b9c772bbeb480b209a3e6ea92b4c" name="a5a85b9c772bbeb480b209a3e6ea92b4c"></a>
static const char *&#160;</td><td class="memItemRight" valign="bottom"><b>TAG</b> = &quot;app_beacon&quot;</td></tr>
<tr class="memdesc:a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tag to be used when logging. <br /></td></tr>
<tr class="separator:a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4103d41f6b46590f9afbaac12ce35e98" id="r_a4103d41f6b46590f9afbaac12ce35e98"><td class="memItemLeft" align="right" valign="top"><a id="a4103d41f6b46590f9afbaac12ce35e98" name="a4103d41f6b46590f9afbaac12ce35e98"></a>
static <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bd">ble_scan_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>scan_status</b> = <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865">ble_scan_uninit</a></td></tr>
<tr class="memdesc:a4103d41f6b46590f9afbaac12ce35e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable that holds BLE scan status. <br /></td></tr>
<tr class="separator:a4103d41f6b46590f9afbaac12ce35e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4ed22f5f5f667dc82f4899aa0bdc71" id="r_a7a4ed22f5f5f667dc82f4899aa0bdc71"><td class="memItemLeft" align="right" valign="top">static esp_ble_scan_params_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a4ed22f5f5f667dc82f4899aa0bdc71">ble_scan_params</a></td></tr>
<tr class="memdesc:a7a4ed22f5f5f667dc82f4899aa0bdc71"><td class="mdescLeft">&#160;</td><td class="mdescRight">BLE scan parameters.  <br /></td></tr>
<tr class="separator:a7a4ed22f5f5f667dc82f4899aa0bdc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8a5c76fd569b6057d16ce79a4d4984" id="r_a2c8a5c76fd569b6057d16ce79a4d4984"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c8a5c76fd569b6057d16ce79a4d4984">scan_statuses_str</a> []</td></tr>
<tr class="memdesc:a2c8a5c76fd569b6057d16ce79a4d4984"><td class="mdescLeft">&#160;</td><td class="mdescRight">BLE scan statuses as strings for debugging.  <br /></td></tr>
<tr class="separator:a2c8a5c76fd569b6057d16ce79a4d4984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760745ffe4296454243fff3861c7013f" id="r_a760745ffe4296454243fff3861c7013f"><td class="memItemLeft" align="right" valign="top"><a id="a760745ffe4296454243fff3861c7013f" name="a760745ffe4296454243fff3861c7013f"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>min_rssi</b> = -47</td></tr>
<tr class="memdesc:a760745ffe4296454243fff3861c7013f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum RSSI for detection (dB) <br /></td></tr>
<tr class="separator:a760745ffe4296454243fff3861c7013f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a33a9029fb7caf6bc0a3bc8313c852" id="r_a06a33a9029fb7caf6bc0a3bc8313c852"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structbeacon__t.html">beacon_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06a33a9029fb7caf6bc0a3bc8313c852">beacon</a></td></tr>
<tr class="memdesc:a06a33a9029fb7caf6bc0a3bc8313c852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable that holds beacon information ///&lt; Beacon information.  <br /></td></tr>
<tr class="separator:a06a33a9029fb7caf6bc0a3bc8313c852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32d7f423777d1c396c95031c556494ef" id="r_a32d7f423777d1c396c95031c556494ef"><td class="memItemLeft" align="right" valign="top"><a id="a32d7f423777d1c396c95031c556494ef" name="a32d7f423777d1c396c95031c556494ef"></a>
static TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>app_beacon__beacon_check_task_handle</b> = NULL</td></tr>
<tr class="memdesc:a32d7f423777d1c396c95031c556494ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Beacon lost check task handle. <br /></td></tr>
<tr class="separator:a32d7f423777d1c396c95031c556494ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains beacon-related code. </p>
<dl class="section author"><dt>Author</dt><dd>Henrique Sander Lourenço (<a href="#" onclick="location.href='mai'+'lto:'+'hen'+'ri'+'que'+'sa'+'nde'+'r2'+'7@g'+'ma'+'il.'+'co'+'m'; return false;">henri<span class="obfuscator">.nosp@m.</span>ques<span class="obfuscator">.nosp@m.</span>ander<span class="obfuscator">.nosp@m.</span>27@g<span class="obfuscator">.nosp@m.</span>mail.<span class="obfuscator">.nosp@m.</span>com</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-03-24</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024 PetDog</dd></dl>
<p>Copyright 2024 PetDog</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at </p><pre class="fragment">http://www.apache.org/licenses/LICENSE-2.0
</pre><p> Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.' See the License for the specific language governing permissions and limitations under the License. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aef00d2df2e65dc4d98e35cf210b017bd" name="aef00d2df2e65dc4d98e35cf210b017bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef00d2df2e65dc4d98e35cf210b017bd">&#9670;&#160;</a></span>ble_scan_status_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#aef00d2df2e65dc4d98e35cf210b017bd">ble_scan_status_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Typedef for storing the status of the BLE scan. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865" name="aef00d2df2e65dc4d98e35cf210b017bda59b4f96b561bad6bad9bbc5f0411c865"></a>ble_scan_uninit&#160;</td><td class="fielddoc"><p>BLE scan uninitialized </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac" name="aef00d2df2e65dc4d98e35cf210b017bdae3a49210dd15f86c1a4c23cd386d59ac"></a>ble_scan_initialing&#160;</td><td class="fielddoc"><p>BLE scan initializing </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5" name="aef00d2df2e65dc4d98e35cf210b017bda900466802c290a0e37ca33133a120fd5"></a>ble_scan_off&#160;</td><td class="fielddoc"><p>BLE scan off </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031" name="aef00d2df2e65dc4d98e35cf210b017bda356515e81874d4125a0070298fcb9031"></a>ble_scan_starting&#160;</td><td class="fielddoc"><p>BLE scan starting </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe" name="aef00d2df2e65dc4d98e35cf210b017bdab0e6902fc86082c2d83d6d961f8971fe"></a>ble_scan_on&#160;</td><td class="fielddoc"><p>BLE scan on </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a" name="aef00d2df2e65dc4d98e35cf210b017bda2d0f95cf71b210fc593e82db4ff7786a"></a>ble_scan_stopping&#160;</td><td class="fielddoc"><p>BLE scan stopping </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1" name="aef00d2df2e65dc4d98e35cf210b017bdab2ed9097868ee188144196f83da99af1"></a>ble_scan_start_pending&#160;</td><td class="fielddoc"><p>BLE scan requested to be started while it could not be instantly started </p>
</td></tr>
<tr><td class="fieldname"><a id="aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b" name="aef00d2df2e65dc4d98e35cf210b017bda2f352f36edc2cd8018526be94ef5330b"></a>ble_scan_stop_pending&#160;</td><td class="fielddoc"><p>BLE scan requested to be stopped while it could not be instantly stopped </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afa355b6e9f4a03afc9af7bf395e7b6f8" name="afa355b6e9f4a03afc9af7bf395e7b6f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa355b6e9f4a03afc9af7bf395e7b6f8">&#9670;&#160;</a></span>app_beacon__beacon_check_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void app_beacon__beacon_check_task </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This task checks if the number of times that the beacon has been seen when the task was resumed is different from the number of times it was seen some seconds later. If the numbers are not different, it means that the beacon has not been seen for some time and in this case the lid will be closed and beacon.found will be set to zero. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a447781418f499b7b9f6fd778500a2bce" name="a447781418f499b7b9f6fd778500a2bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447781418f499b7b9f6fd778500a2bce">&#9670;&#160;</a></span>app_beacon__ble_gap_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void app_beacon__ble_gap_cb </td>
          <td>(</td>
          <td class="paramtype">esp_gap_ble_cb_event_t</td>          <td class="paramname"><span class="paramname"><em>event</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_ble_gap_cb_param_t *</td>          <td class="paramname"><span class="paramname"><em>param</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>BLE GAP event handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>Tell which event happened. </td></tr>
    <tr><td class="paramname">param</td><td>Pointer to union with other event data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abe33c18c55161d20e7aff59090894e32" name="abe33c18c55161d20e7aff59090894e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe33c18c55161d20e7aff59090894e32">&#9670;&#160;</a></span>app_beacon__ble_scan_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t app_beacon__ble_scan_start </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start BLE scan. If scan is stopping, scan start is put into pending state, so it is started after it finishes stopping. </p>
<dl class="section return"><dt>Returns</dt><dd>esp_err_t </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ESP_OK</td><td>on success. </td></tr>
    <tr><td class="paramname">Error</td><td>code on failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a929b0ba225cd078bc7f114f7ff00f3d0" name="a929b0ba225cd078bc7f114f7ff00f3d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a929b0ba225cd078bc7f114f7ff00f3d0">&#9670;&#160;</a></span>app_beacon__ble_scan_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t app_beacon__ble_scan_stop </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop BLE scan. If scan is starting, scan stop is put into pending state, so it is stopped after it finishes starting. </p>
<dl class="section return"><dt>Returns</dt><dd>esp_err_t </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ESP_OK</td><td>on success. </td></tr>
    <tr><td class="paramname">Error</td><td>code on failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab7400345952e53011876e57971505a65" name="ab7400345952e53011876e57971505a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7400345952e53011876e57971505a65">&#9670;&#160;</a></span>app_beacon__init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t app_beacon__init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize necessary stuff to perform BLE scan. </p>
<dl class="section return"><dt>Returns</dt><dd>esp_err_t </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ESP_OK</td><td>on success. </td></tr>
    <tr><td class="paramname">Error</td><td>code on failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a40cdef624cff3637675eac3102b290d2" name="a40cdef624cff3637675eac3102b290d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40cdef624cff3637675eac3102b290d2">&#9670;&#160;</a></span>app_beacon__set_auth_mac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_beacon__set_auth_mac </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>mac_addr</em>[6]</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets authorized MAC address in beacon structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mac_addr</td><td>6 bytes array with authorized MAC address. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a06a33a9029fb7caf6bc0a3bc8313c852" name="a06a33a9029fb7caf6bc0a3bc8313c852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a33a9029fb7caf6bc0a3bc8313c852">&#9670;&#160;</a></span>beacon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbeacon__t.html">beacon_t</a> beacon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .auth_mac = {0},</div>
<div class="line">    .found = 0,</div>
<div class="line">    .times_seen = 0,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Variable that holds beacon information ///&lt; Beacon information. </p>

</div>
</div>
<a id="a7a4ed22f5f5f667dc82f4899aa0bdc71" name="a7a4ed22f5f5f667dc82f4899aa0bdc71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4ed22f5f5f667dc82f4899aa0bdc71">&#9670;&#160;</a></span>ble_scan_params</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_ble_scan_params_t ble_scan_params</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .scan_type = BLE_SCAN_TYPE_PASSIVE,</div>
<div class="line">    .own_addr_type = BLE_ADDR_TYPE_PUBLIC,</div>
<div class="line">    .scan_filter_policy = BLE_SCAN_FILTER_ALLOW_ALL,</div>
<div class="line">    .scan_interval = 500, </div>
<div class="line">    .scan_window = 400,   </div>
<div class="line">    .scan_duplicate = BLE_SCAN_DUPLICATE_DISABLE,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>BLE scan parameters. </p>

</div>
</div>
<a id="a2c8a5c76fd569b6057d16ce79a4d4984" name="a2c8a5c76fd569b6057d16ce79a4d4984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8a5c76fd569b6057d16ce79a4d4984">&#9670;&#160;</a></span>scan_statuses_str</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* scan_statuses_str[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_uninit&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_initialing&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_off&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_starting&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_on&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_stopping&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_start_pending&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ble_scan_stop_pending&quot;</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>BLE scan statuses as strings for debugging. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
